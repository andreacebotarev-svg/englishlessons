# üé¨ Cinematic Camera System (Portal 2 Style)

## –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –∫–∏–Ω–µ–º–∞—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–π –∫–∞–º–µ—Ä—ã –¥–ª—è 3D-–∫–æ—Ä–∏–¥–æ—Ä–∞ —Å –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏ –∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö —Å–ª–æ–≤. –†–µ–∞–ª–∏–∑—É–µ—Ç –ø–ª–∞–≤–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ –ø–æ –∑–∞–¥–∞–Ω–Ω—ã–º —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏—è–º, –∞–≤—Ç–æ—Ñ–æ–∫—É—Å –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö –∏ "—Å–∏–Ω–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π" —ç—Ñ—Ñ–µ–∫—Ç.

**üé¨ –ù–û–í–ò–ù–ö–ê: –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ cinematic –∫–∞–º–µ—Ä—ã –≤ —Å—Ç–∏–ª–µ Portal 2!**
- –ü–ª–∞–≤–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏ —Å GSAP
- –î–≤–∏–∂–µ–Ω–∏–µ –ø–æ —Ä–µ–ª—å—Å–∞–º (Catmull-Rom splines)
- –ê–≤—Ç–æ—Ñ–æ–∫—É—Å –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö
- –£–∑–∫–∏–π FOV –¥–ª—è –∫–∏–Ω–µ–º–∞—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞
- –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π –∏ –º—ã—à—å—é

## –§–∞–π–ª—ã

- `CinematicCamera.js` - –û—Å–Ω–æ–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–∞–º–µ—Ä—ã
- `CameraControls.js` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π –∏ –º—ã—à—å—é
- `example_integration.js` - –ü—Ä–∏–º–µ—Ä –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ –ø—Ä–æ–µ–∫—Ç

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### ‚úÖ –°–∏—Å—Ç–µ–º–∞ —Ä–µ–ª—å—Å–æ–≤ (Rail System)
- Catmull-Rom –∫—Ä–∏–≤–∞—è –¥–ª—è –ø–ª–∞–≤–Ω–æ–≥–æ –ø—É—Ç–∏ –∫–∞–º–µ—Ä—ã
- –î–≤–∏–∂–µ–Ω–∏–µ –≤–¥–æ–ª—å Z-–æ—Å–∏ —á–µ—Ä–µ–∑ –∫–∞—Ä—Ç–æ—á–∫–∏
- –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ (–ø–∞—Ä–∞–º–µ—Ç—Ä 0..1)
- Waypoints –¥–ª—è –∫–ª—é—á–µ–≤—ã—Ö –ø–æ–∑–∏—Ü–∏–π

### ‚úÖ –ü–ª–∞–≤–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã
- GSAP –∞–Ω–∏–º–∞—Ü–∏–∏ (–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å 1-3 —Å–µ–∫—É–Ω–¥—ã)
- Easing: power2.inOut, power1.inOut
- –ò–Ω–µ—Ä—Ü–∏—è –ø—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏
- –ü–ª–∞–≤–Ω–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ/–∑–∞–º–µ–¥–ª–µ–Ω–∏–µ

### ‚úÖ –ê–≤—Ç–æ—Ñ–æ–∫—É—Å
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤–∑–≥–ª—è–¥ –Ω–∞ –±–ª–∏–∂–∞–π—à—É—é –∫–∞—Ä—Ç–æ—á–∫—É
- –ü–ª–∞–≤–Ω–æ–µ –≤—Ä–∞—â–µ–Ω–∏–µ (SLERP quaternion)
- –§–æ–∫—É—Å –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É –ø—Ä–∏ –∫–ª–∏–∫–µ

### ‚úÖ –£–∑–∫–∏–π —É–≥–æ–ª –æ–±–∑–æ—Ä–∞
- FOV = 35¬∞ –¥–ª—è –∫–∏–Ω–µ–º–∞—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ FOV –ø—Ä–∏ zoom

### ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- **WASD / –°—Ç—Ä–µ–ª–∫–∏** - –¥–≤–∏–∂–µ–Ω–∏–µ –≤–ø–µ—Ä—ë–¥/–Ω–∞–∑–∞–¥ –ø–æ —Ä–µ–ª—å—Å–∞–º
- **Space** - –ø–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É waypoint
- **Home** - –ø–µ—Ä–µ—Ö–æ–¥ –∫ –Ω–∞—á–∞–ª—É –∫–æ—Ä–∏–¥–æ—Ä–∞
- **End** - –ø–µ—Ä–µ—Ö–æ–¥ –∫ –∫–æ–Ω—Ü—É –∫–æ—Ä–∏–¥–æ—Ä–∞
- **Escape** - –≤–æ–∑–≤—Ä–∞—Ç –∫ —Ä–µ–∂–∏–º—É —Ä–µ–ª—å—Å–æ–≤
- **R** - –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç–∏ —Ä–µ–ª—å—Å–æ–≤
- **–ö–ª–∏–∫ –º—ã—à—å—é** - —Ñ–æ–∫—É—Å –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
npm install three gsap
```

### 2. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –º–æ–¥—É–ª–∏

```javascript
import * as THREE from 'three';
import gsap from 'gsap';
import { CinematicCamera } from './palace_engine/CinematicCamera.js';
import { CameraControls } from './palace_engine/CameraControls.js';
```

### 3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

```javascript
// –°–æ–∑–¥–∞–π—Ç–µ —Å—Ü–µ–Ω—É –∏ –∫–∞–º–µ—Ä—É
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);

// –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –º–∞—Å—Å–∏–≤ –∫–∞—Ä—Ç–æ—á–µ–∫ (THREE.Mesh –æ–±—ä–µ–∫—Ç—ã)
const cards = [];
// ... —Å–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Å–∏—Å—Ç–µ–º—É
const cinematicCamera = new CinematicCamera(scene, camera, cards);
const controls = new CameraControls(cinematicCamera);

// –í –∞–Ω–∏–º–∞—Ü–∏–æ–Ω–Ω–æ–º —Ü–∏–∫–ª–µ
function animate() {
  requestAnimationFrame(animate);
  
  cinematicCamera.update(deltaTime);
  
  renderer.render(scene, camera);
}
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

```javascript
cinematicCamera.setParams({
  acceleration: 0.002,        // –£—Å–∫–æ—Ä–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è
  friction: 0.90,             // –¢—Ä–µ–Ω–∏–µ (0.9 = –±–æ–ª—å—à–µ –∏–Ω–µ—Ä—Ü–∏–∏)
  maxVelocity: 0.01,          // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å
  lookAheadDistance: 0.08,    // –î–∏—Å—Ç–∞–Ω—Ü–∏—è "–≤–∑–≥–ª—è–¥–∞ –≤–ø–µ—Ä—ë–¥"
  fov: 30,                    // –£–≥–æ–ª –æ–±–∑–æ—Ä–∞ (20-40 –¥–ª—è cinematic)
  rotationSpeed: 0.05,        // –°–∫–æ—Ä–æ—Å—Ç—å –ø–æ–≤–æ—Ä–æ—Ç–∞ (–º–µ–Ω—å—à–µ = –ø–ª–∞–≤–Ω–µ–µ)
  animationDuration: 3,       // –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å GSAP –∞–Ω–∏–º–∞—Ü–∏–π
  easing: 'power2.inOut'      // –¢–∏–ø —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è
});
```

## API

### CinematicCamera

#### –ú–µ—Ç–æ–¥—ã

- `update(deltaTime)` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã (–≤—ã–∑—ã–≤–∞—Ç—å –∫–∞–∂–¥—ã–π –∫–∞–¥—Ä)
- `moveToWaypoint(index)` - –ü–µ—Ä–µ—Ö–æ–¥ –∫ waypoint –ø–æ –∏–Ω–¥–µ–∫—Å—É
- `focusOnCard(card, zoom)` - –§–æ–∫—É—Å –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É —Å –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º zoom
- `returnToRail()` - –í–æ–∑–≤—Ä–∞—Ç –∫ —Ä–µ–∂–∏–º—É –¥–≤–∏–∂–µ–Ω–∏—è –ø–æ —Ä–µ–ª—å—Å–∞–º
- `jumpToStart()` - –ë—ã—Å—Ç—Ä—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –∫ –Ω–∞—á–∞–ª—É
- `jumpToEnd()` - –ë—ã—Å—Ç—Ä—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –∫ –∫–æ–Ω—Ü—É
- `toggleRailVisualization()` - –ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é —Ä–µ–ª—å—Å–æ–≤
- `setParams(params)` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- `dispose()` - –û—á–∏—Å—Ç–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤

#### –°–≤–æ–π—Å—Ç–≤–∞

- `currentT` - –¢–µ–∫—É—â–∞—è –ø–æ–∑–∏—Ü–∏—è –Ω–∞ –∫—Ä–∏–≤–æ–π (0..1)
- `velocity` - –¢–µ–∫—É—â–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –¥–≤–∏–∂–µ–Ω–∏—è
- `isAnimating` - –§–ª–∞–≥ –∞–∫—Ç–∏–≤–Ω–æ–π –∞–Ω–∏–º–∞—Ü–∏–∏
- `focusedCard` - –¢–µ–∫—É—â–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ –≤ —Ñ–æ–∫—É—Å–µ
- `autoFocusEnabled` - –í–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ –∞–≤—Ç–æ—Ñ–æ–∫—É—Å–∞

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –§–æ–∫—É—Å –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –∫–∞—Ä—Ç–æ—á–∫—É

```javascript
const targetCard = cards[5];
cinematicCamera.focusOnCard(targetCard, true); // —Å zoom
```

### –ü–ª–∞–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –∫ —Å–µ—Ä–µ–¥–∏–Ω–µ –∫–æ—Ä–∏–¥–æ—Ä–∞

```javascript
cinematicCamera.animateToT(0.5, 3); // t=0.5, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å 3 —Å–µ–∫
```

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –¥–≤–∏–∂–µ–Ω–∏—è

```javascript
cinematicCamera.setParams({
  maxVelocity: 0.015,  // –ë—ã—Å—Ç—Ä–µ–µ
  friction: 0.85        // –ú–µ–Ω—å—à–µ –∏–Ω–µ—Ä—Ü–∏–∏
});
```

## –û—Ç–ª–∞–¥–∫–∞

–í–∫–ª—é—á–∏—Ç–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é —Ä–µ–ª—å—Å–æ–≤ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:

```javascript
cinematicCamera.visualizeRail(true); // –ó–µ–ª—ë–Ω–∞—è –ª–∏–Ω–∏—è —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏ waypoints
```

–ò–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –∫–ª–∞–≤–∏—à—É **R** –≤–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è 60 FPS
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –≤ update()
- GSAP –∞–Ω–∏–º–∞—Ü–∏–∏ hardware-accelerated
- SLERP quaternion –≤–º–µ—Å—Ç–æ Euler angles (–Ω–µ—Ç gimbal lock)

## –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

- –ü—Ä–∏ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ waypoints (>15) –¥–≤–∏–∂–µ–Ω–∏–µ –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å "–¥—ë—Ä–≥–∞–Ω—ã–º"
- –†–µ—à–µ–Ω–∏–µ: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–Ω—å—à–µ waypoints –∏ —É–≤–µ–ª–∏—á—å—Ç–µ tension –∫—Ä–∏–≤–æ–π

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- THREE.js r128+
- GSAP 3.12+
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT
