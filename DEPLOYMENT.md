# üöÄ Deployment Guide

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:

```
/
‚îú‚îÄ‚îÄ trainer/           # –°–æ–±—Ä–∞–Ω–Ω–æ–µ React-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ index.html
‚îÇ   ‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index-[hash].js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index-[hash].css
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ data/              # JSON —Å —É—Ä–æ–∫–∞–º–∏ (–ü–ê–†–ê–õ–õ–ï–õ–¨–ù–û —Å trainer!)
    ‚îú‚îÄ‚îÄ lesson_01.json
    ‚îú‚îÄ‚îÄ lesson_02.json
    ‚îî‚îÄ‚îÄ lesson_03.json
```

## –ú–µ—Ç–æ–¥ 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π (GitHub Actions)

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GitHub Pages

1. –û—Ç–∫—Ä–æ–π—Ç–µ **Settings** ‚Üí **Pages**
2. Source: **Deploy from a branch**
3. Branch: **gh-pages** ‚Üí folder: **/ (root)**
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ

### –ê–∫—Ç–∏–≤–∞—Ü–∏—è workflow

```bash
git push origin main
```

GitHub Actions –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –°–æ–±–µ—Ä—ë—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- –°–∫–æ–ø–∏—Ä—É–µ—Ç data/ —Ä—è–¥–æ–º —Å dist/
- –ó–∞–¥–µ–ø–ª–æ–∏—Ç –Ω–∞ GitHub Pages

## –ú–µ—Ç–æ–¥ 2: –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π

### –®–∞–≥ 1: –°–±–æ—Ä–∫–∞

```bash
cd trainer
npm install
npm run build
```

### –®–∞–≥ 2: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ñ–∞–π–ª–æ–≤

```bash
# –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è –¥–µ–ø–ª–æ—è
mkdir -p deploy/trainer
cp -r trainer/dist/* deploy/trainer/
cp -r data deploy/
```

### –®–∞–≥ 3: –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

**–ß–µ—Ä–µ–∑ FTP/SFTP:**
```
–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ deploy/ –≤ –∫–æ—Ä–µ–Ω—å —Å–∞–π—Ç–∞
```

**–ß–µ—Ä–µ–∑ SSH:**
```bash
scp -r deploy/* user@eng-tutor.ru:/var/www/html/
```

## –ú–µ—Ç–æ–¥ 3: Custom Domain (eng-tutor.ru)

### Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```nginx
server {
    listen 80;
    server_name eng-tutor.ru;
    root /var/www/html;

    # Trainer SPA
    location /trainer {
        try_files $uri $uri/ /trainer/index.html;
    }

    # Data JSON
    location /data {
        add_header Content-Type application/json;
        add_header Access-Control-Allow-Origin *;
    }
}
```

## üîç Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–µ–ª—ã–π —ç–∫—Ä–∞–Ω

**–†–µ—à–µ–Ω–∏–µ 1: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)**

–û—à–∏–±–∫–∏ —Ç–∏–ø–∞:
- `404 Not Found` ‚Üí –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º
- `Failed to fetch` ‚Üí –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ data/
- `Unexpected token '<'` ‚Üí –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π basename –≤ —Ä–æ—É—Ç–µ—Ä–µ

**–†–µ—à–µ–Ω–∏–µ 2: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–∑–æ–≤—ã–π –ø—É—Ç—å**

–í `trainer/src/app/router.tsx`:
```typescript
basename: '/trainer'  // –î–æ–ª–∂–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å URL!
```

–í `trainer/vite.config.ts`:
```typescript
base: '/trainer/'  // –° —Å–ª—ç—à–µ–º –≤ –∫–æ–Ω—Ü–µ!
```

**–†–µ—à–µ–Ω–∏–µ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ñ–∞–π–ª–æ–≤**

–û—Ç–∫—Ä–æ–π—Ç–µ DevTools ‚Üí Network:
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ª–∏ `index.html`?
- –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ª–∏ `.js` –∏ `.css` –∏–∑ `/trainer/assets/`?
- –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ª–∏ JSON –∏–∑ `/data/`?

### –ü—Ä–æ–±–ª–µ–º–∞: JSON –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º:** –û—à–∏–±–∫–∞ `Failed to load lesson: 404`

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ data/ –Ω–∞ —Ç–æ–º –∂–µ —É—Ä–æ–≤–Ω–µ, —á—Ç–æ –∏ trainer/
ls -la /var/www/html/
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
# drwxr-xr-x trainer/
# drwxr-xr-x data/
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—É—Ç–∏ –≤ –∫–æ–¥–µ:**

`trainer/src/shared/api/lesson-loader.ts`:
```typescript
const basePath = isDev ? '../../data' : '../data';
```

### –ü—Ä–æ–±–ª–µ–º–∞: –†–æ—É—Ç–∏–Ω–≥ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–°–∏–º–ø—Ç–æ–º:** –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ `/trainer/lesson/lesson_01` –¥–∞—ë—Ç 404

**–†–µ—à–µ–Ω–∏–µ (Nginx):**
```nginx
location /trainer {
    try_files $uri $uri/ /trainer/index.html;
}
```

**–†–µ—à–µ–Ω–∏–µ (Apache):**
```apache
<Directory /var/www/html/trainer>
    RewriteEngine On
    RewriteBase /trainer/
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /trainer/index.html [L]
</Directory>
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ê—É–¥–∏–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –Ω–∞ –æ—à–∏–±–∫–∏ Speech API
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ HTTPS –≤–∫–ª—é—á—ë–Ω (—Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ –±—Ä–∞—É–∑–µ—Ä–æ–≤)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ permissions –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ (–Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è, –Ω–æ –∏–Ω–æ–≥–¥–∞ –±–ª–æ–∫–∏—Ä—É–µ—Ç)

### –ü—Ä–æ–±–ª–µ–º–∞: –ê–Ω–∏–º–∞—Ü–∏–∏ —Ç–æ—Ä–º–æ–∑—è—Ç

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
// –í PhonemeBuilder.tsx –æ—Ç–∫–ª—é—á–∏—Ç–µ —Ç—è–∂—ë–ª—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
initial={{ scale: 1 }}  // –í–º–µ—Å—Ç–æ —Å–ª–æ–∂–Ω—ã—Ö –∞–Ω–∏–º–∞—Ü–∏–π
```

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

- [ ] `npm run build` –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] `npm run preview` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞–±–æ—á–µ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- [ ] –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤: `trainer/` + `data/` –Ω–∞ –æ–¥–Ω–æ–º —É—Ä–æ–≤–Ω–µ
- [ ] basename –≤ router.tsx = URL –ø—É—Ç–∏
- [ ] base –≤ vite.config.ts = URL –ø—É—Ç–∏ + `/`
- [ ] Nginx/Apache –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è SPA
- [ ] HTTPS –≤–∫–ª—é—á—ë–Ω (–¥–ª—è Speech API)
- [ ] CORS —Ä–∞–∑—Ä–µ—à—ë–Ω –¥–ª—è `/data/` (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

## üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

### 1. –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
```
https://eng-tutor.ru/trainer/
```
- ‚úÖ –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å 3 –∫–∞—Ä—Ç–æ—á–∫–∏ —É—Ä–æ–∫–æ–≤
- ‚úÖ –ê–Ω–∏–º–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏

### 2. –°—Ç—Ä–∞–Ω–∏—Ü–∞ —É—Ä–æ–∫–∞
```
https://eng-tutor.ru/trainer/lesson/lesson_01
```
- ‚úÖ –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∫–∞—Ä—Ç–æ—á–∫–∞ —Å–æ —Å–ª–æ–≤–æ–º
- ‚úÖ –≠–º–æ–¥–∑–∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- ‚úÖ –ö–Ω–æ–ø–∫–∞ üîä –æ–∑–≤—É—á–∏–≤–∞–µ—Ç —Å–ª–æ–≤–æ
- ‚úÖ –ö–ª–∏–∫ –ø–æ —Ñ–æ–Ω–µ–º–µ –æ–∑–≤—É—á–∏–≤–∞–µ—Ç –µ—ë
- ‚úÖ –°–ª–æ—Ç—ã –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è

### 3. Network –ø—Ä–æ–≤–µ—Ä–∫–∞
–û—Ç–∫—Ä–æ–π—Ç–µ DevTools ‚Üí Network:
- ‚úÖ `GET /trainer/` ‚Üí 200
- ‚úÖ `GET /data/lesson_01.json` ‚Üí 200
- ‚úÖ `GET /trainer/assets/index-[hash].js` ‚Üí 200

## üÜò –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–ª–æ

1. –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞ (Ctrl+Shift+Del)
2. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤ —Ä–µ–∂–∏–º–µ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞:
   ```bash
   tail -f /var/log/nginx/error.log
   ```
4. –ü—Ä–∏—à–ª–∏—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç:
   - –ö–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ (F12 ‚Üí Console)
   - Network –≤–∫–ª–∞–¥–∫–∏ (F12 ‚Üí Network)
   - –°—Ç—Ä—É–∫—Ç—É—Ä—ã —Ñ–∞–π–ª–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

## üìû Support

–°–æ–∑–¥–∞–π—Ç–µ issue –≤ [GitHub Issues](https://github.com/andreacebotarev-svg/englishlessons/issues)
